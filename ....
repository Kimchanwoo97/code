sing System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using static System.Console;
using static System.Threading.Thread;

namespace ConsoleApp1
{
    class Screen
    {

        public void Comscreen()
        {
            int num = 2, num1 = 0;

            SetCursorPosition(18, 1);
            ForegroundColor = ConsoleColor.Red;
            WriteLine("Com Screen");

            for (int i = 0; i < 1; i++)
            {
                for (int j = 1; j <= 10; j++)
                {
                    ForegroundColor = ConsoleColor.Blue;
                    SetCursorPosition(0, num += 2);
                    WriteLine(j);
                }
                SetCursorPosition(0, 24);
                WriteLine("Y");
            }

            for (int i = 0; i < 1; i++)
            {
                for (int j = 1; j <= 10; j++)
                {
                    ForegroundColor = ConsoleColor.Blue;
                    SetCursorPosition(num1 += 4, 2);
                    Write(j);
                }
                SetCursorPosition(44, 2);
                WriteLine("X");
            }

            ForegroundColor = ConsoleColor.White;
            SetCursorPosition(2, 3);
            WriteLine("┏━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┓");
            for (int i = 0; i < 9; i++)
            {
                SetCursorPosition(2, 4 + i * 2);
                WriteLine("┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃");
                SetCursorPosition(2, 5 + i * 2);
                WriteLine("┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫");
            }
            SetCursorPosition(2, 22);
            WriteLine("┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃");
            SetCursorPosition(2, 23);
            WriteLine("┗━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┛");
        }

        public void Playerscreen()
        {
            int num = 2, num1 = 52;

            SetCursorPosition(70, 1);
            ForegroundColor = ConsoleColor.Red;
            WriteLine("Plyer Screen");

            for (int i = 0; i < 1; i++)
            {
                for (int j = 1; j <= 10; j++)
                {
                    ForegroundColor = ConsoleColor.Blue;
                    SetCursorPosition(52, num += 2);
                    WriteLine(j);
                }
                SetCursorPosition(52, 24);
                WriteLine("Y");
            }

            for (int i = 0; i < 1; i++)
            {
                for (int j = 1; j <= 10; j++)
                {
                    ForegroundColor = ConsoleColor.Blue;
                    SetCursorPosition(num1 += 4, 2);
                    Write(j);
                }
                SetCursorPosition(96, 2);
                WriteLine("X");
            }

            ForegroundColor = ConsoleColor.White;
            SetCursorPosition(54, 3);
            WriteLine("┏━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┓");
            for (int i = 0; i < 9; i++)
            {
                SetCursorPosition(54, 4 + i * 2);
                WriteLine("┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃");
                SetCursorPosition(54, 5 + i * 2);
                WriteLine("┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫");
            }
            SetCursorPosition(54, 22);
            WriteLine("┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃");
            SetCursorPosition(54, 23);
            WriteLine("┗━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┛");
        }
        public void Earlyscreen()
        {
            SetCursorPosition(30, 10);
            WriteLine("┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓");
            for (int i = 0; i < 5; i++)
            {
                SetCursorPosition(30, 11 + i);
                WriteLine("┃                                            ┃");
            }
            SetCursorPosition(30, 16);
            WriteLine("┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛");

            SetCursorPosition(48, 12);
            ForegroundColor = ConsoleColor.Red;
            WriteLine("Gmae start");

            ForegroundColor = ConsoleColor.White;
            SetCursorPosition(38, 14);
            WriteLine("Enter를 누르면 게임을 시작합니다.");


        }
    }

    class Tast
    {
        public static void Obj(int x, int y, string s)
        {
            SetCursorPosition(x, y);
            WriteLine(s);
        }

        public static void itam(int x, int y)
        {
            SetCursorPosition(x, y);
            WriteLine("유도탄 발사에 실패하였습니다.");
        }

        public static void Obj2(int x, int y, int s, int s1, string name)
        {
            SetCursorPosition(x, y);
            WriteLine($"{name}가 ({(s1 - 2) / 2}, {s / 4})칸을 조사 하였습니다.");
        }
        public static void Obj3(int x, int y, int s, int s1, string name)
        {
            SetCursorPosition(x, y);
            WriteLine($"{name}가 ({(s1 - 2) / 2}, {s / 4})에서 적을 찾았습니다.");
        }
        public static void Obj4(int x, int y, int s, int s1, string name)
        {
            SetCursorPosition(x, y);
            WriteLine($"{name}가 ({(s1 - 2) / 2}, {(s - 52) / 4})에서 적을 찾았습니다.");
        }
        public static void Objxy(int x, int y, int s, int s1 ,string name)
        {
            SetCursorPosition(x, y);
            WriteLine($"{name}가 유도탄을 보내 ({(s1-2) /2}, {s / 4})위치의 적함대를 파괴하였습니다");
        }
        public static void Objxy2(int x, int y, int s, int s1, string name)
        {
            SetCursorPosition(x, y);
            WriteLine($"{name}이 유도탄을 보내 ({(s1 - 2) / 2}, {s / 4})위치의 적함대를 파괴하였습니다");
        }



        public void Game()
        {
            CursorVisible = false;

            Screen screen = new Screen();

            Random r = new Random();
            ConsoleKey key;
            bool c = true, c1 = true, c2 = true, c3 = true, pitam = true;
            bool p = true, p1 = true, p2 = true, p3 = true, citam = true;

            int mx, my;

            mx = 4;
            my = 4;

            int x, y, x1, y1, x2, y2, x3, y3;
            int px, px1, px2, px3, py, py1, py2, py3;
            int pskillx, pskilly, cskillx, cskilly;

            int fixednum = 52, fixednum1 = 2;
            int i, num;

            int count = 0;



            #region com xy값                             
            while (true)
            {
                while (true)
                {
                    x = r.Next(4, 41);
                    y = r.Next(5, 23);

                    if (x % 4 == 0 && y % 2 == 0)
                    {
                        break;
                    }
                }

                while (true)
                {
                    x1 = r.Next(4, 41);
                    y1 = r.Next(5, 23);

                    if (x1 % 4 == 0 && y1 % 2 == 0)
                    {
                        break;
                    }
                }

                while (true)
                {
                    x2 = r.Next(4, 41);
                    y2 = r.Next(5, 23);

                    if (x2 % 4 == 0 && y2 % 2 == 0)
                    {
                        break;
                    }
                }

                while (true)
                {
                    x3 = r.Next(4, 41);
                    y3 = r.Next(5, 23);

                    if (x3 % 4 == 0 && y3 % 2 == 0)
                    {
                        break;
                    }
                }

                if (x == y || x == x2 || x == x3 || x1 == x2 || x1 == x3 || x2 == x3)
                {
                    if (y != y1 && y != y2 && y != y3 && y1 != y2 && y1 != y3 && y2 != y3)
                        break;
                    else
                        continue;
                }
                else if (y == y1 || y == y2 || y == y3 || y1 == y2 || y1 == y3 || y2 == y3)
                {
                    if (x != x1 && x != x2 && x != x3 && x1 != x2 && x1 != x3 && x2 != x3)
                        break;
                    else
                        continue;
                }
                else
                    break;

            }


            while (true)
            {
                Clear();
                WriteLine("위치는 1 ~ 10으로 정할수 있습니다");
                WriteLine();
                i = 1;

                Write($"x : {i}번째 x위치를 입력해주세요 : ");
                num = int.Parse(ReadLine());
                px = fixednum + (num * 4);

                Write($"y : {i}번째 y위치를 입력해주세요 : ");
                num = int.Parse(ReadLine());
                py = fixednum1 + (num * 2);
                ++i;

                Write($"x : {i}번째 x위치를 입력해주세요 : ");
                num = int.Parse(ReadLine());
                px1 = fixednum + (num * 4);

                Write($"y : {i}번째 y위치를 입력해주세요 : ");
                num = int.Parse(ReadLine());
                py1 = fixednum1 + (num * 2);
                ++i;

                Write($"x : {i}번째 x위치를 입력해주세요 : ");
                num = int.Parse(ReadLine());
                px2 = fixednum + (num * 4);

                Write($"y : {i}번째 y위치를 입력해주세요 : ");
                num = int.Parse(ReadLine());
                py2 = fixednum1 + (num * 2);
                ++i;

                Write($"x : {i}번째 x위치를 입력해주세요 : ");
                num = int.Parse(ReadLine());
                px3 = fixednum + (num * 4);

                Write($"y : {i}번째 y위치를 입력해주세요 : ");
                num = int.Parse(ReadLine());
                py3 = fixednum1 + (num * 2);


                if (py == px1 || px == px2 || px == px3 || px1 == px2 || px1 == px3 || px2 == px3)
                {
                    if (py != py1 && py != py2 && py != py3 && py1 != py2 && py1 != py3 && py2 != py3)
                        break;
                    else
                        continue;
                }
                else if (py == py1 || py == py2 || py == py3 || py1 == py2 || py1 == py3 || py2 == py3)
                {
                    if (px != px1 && px != px2 && px != px3 && px1 != px2 && px1 != px3 && px2 != px3)
                        break;
                    else
                        continue;
                }
                else
                    break;

            }


            while (true)
            {
                pskillx = r.Next(4, 41);
                pskilly = r.Next(5, 23);

                if (pskillx % 4 == 0 && pskilly % 2 == 0)
                {
                    break;
                }

            }


            int rnum, rnum1;

            rnum = r.Next(1, 10);
            rnum1 = r.Next(1, 10);

            cskillx = fixednum + (rnum * 4);
            cskilly = fixednum1 + (rnum1 * 2);


            #endregion

            bool play = true;

            while (true)
            {
                Clear();

                screen.Comscreen();
                screen.Playerscreen();

                if (p)
                {
                    Obj(px, py, "♣");
                }
                if (p1)
                {
                    Obj(px1, py1, "♠");
                }
                if (p2)
                {
                    Obj(px2, py2, "♥");
                }
                if (p3)
                {
                    Obj(px3, py3, "◆");
                }
                if (pitam)
                {
                    Obj(pskillx, pskilly, "※");
                }

                if (c)
                {
                    Obj(x, y, "♣");
                }
                if (c1)
                {
                    Obj(x1, y1, "♠");
                }
                if (c2)
                {
                    Obj(x2, y2, "♥");
                }
                if (c3)
                {
                    Obj(x3, y3, "◆");
                }
                if (citam)
                {
                    Obj(cskillx, cskilly, "※");
                }

                if (play)
                {
                    ForegroundColor = ConsoleColor.Blue;
                    Obj(mx, my, "■");

                    ForegroundColor = ConsoleColor.White;
                    key = ReadKey(true).Key;

                    switch (key)
                    {
                        case ConsoleKey.LeftArrow:
                            if (mx > 4) mx -= 4;
                            break;
                        case ConsoleKey.RightArrow:
                            if (mx < 40) mx += 4;
                            break;
                        case ConsoleKey.UpArrow:
                            if (my > 4) my -= 2;
                            break;
                        case ConsoleKey.DownArrow:
                            if (my < 22) my += 2;
                            break;
                        case ConsoleKey.Enter:
                            if (!c && mx == x && my == y)
                            {
                                Obj2(5, 25, mx, my, "player");
                                Sleep(1000);
                                play = false;
                                count++;
                            }
                            else if (!c1 && mx == x1 && my == y1)
                            {
                                Obj2(5, 25, mx, my, "player");
                                Sleep(1000);
                                play = false;
                                count++;
                            }
                            else if (!c2 && mx == x2 && my == y2)
                            {
                                Obj2(5, 25, mx, my, "player");
                                Sleep(1000);
                                play = false;
                                count++;
                            }
                            else if (!c3 && mx == x3 && my == y3)
                            {
                                Obj2(5, 25, mx, my, "player");
                                Sleep(1000);
                                play = false;
                                count++;
                            }
                            else if (mx == x && my == y)
                            {
                                c = false;
                                Obj3(5, 25, mx, my, "player");
                                Sleep(1000);
                                play = false;
                                count++;
                            }
                            else if (mx == x1 && my == y1)
                            {
                                c1 = false;
                                Obj3(5, 25, mx, my, "player");
                                Sleep(1000);
                                play = false;
                                count++;
                            }
                            else if (mx == x2 && my == y2)
                            {
                                c2 = false;
                                Obj3(5, 25, mx, my, "player");
                                Sleep(1000);
                                play = false;
                                count++;
                            }
                            else if (mx == x3 && my == y3)
                            {
                                c3 = false;
                                Obj3(5, 25, mx, my, "player");
                                Sleep(1000);
                                play = false;
                                count++;
                            }
                            else if(mx == pskillx && my == pskilly)
                            {
                                if(pitam)
                                {
                                    SetCursorPosition(5, 26);
                                    WriteLine("player가 유도탄 스위치를 찾았습니다");
                                    Sleep(2000);
                                    int itampr = r.Next(1,5);
                                    switch(itampr)
                                    {
                                        case 1:
                                            if (c)
                                            {
                                                Objxy(15, 27, x, y, "player"); Sleep(1000);
                                                c = false;
                                                count++;
                                            }
                                            else
                                            {
                                                itam(5, 27);
                                                count++;
                                            }
                                            break;
                                        case 2:                                           
                                            if (c1)
                                            {
                                                Objxy(15, 27, x1, y1, "player"); Sleep(1000);
                                                c1 = false;
                                                count++;
                                            }
                                            else
                                            {
                                                itam(5, 27);
                                                count++;
                                            }
                                            break;
                                        case 3:
                                            if (c2)
                                            {
                                                Objxy(15, 27, x2, y2, "player"); Sleep(1000);
                                                c2 = false;
                                                count++;
                                            }
                                            else
                                            {
                                                itam(5, 27);
                                                count++;
                                            }
                                            break;
                                        case 4:
                                            if (c3)
                                            {
                                                Objxy(15, 27, x3, y3, "player"); Sleep(1000);
                                                c3 = false;
                                                count++;
                                            }
                                            else
                                            {
                                                itam(5, 27);
                                                count++;
                                            }
                                            break;
                                   
                                    }
                                }
                                else
                                {
                                    Obj2(5, 25, mx, my, "player");
                                    Sleep(1000);
                                    count++;                                    
                                }
                                pitam = false;
                                play = false;
                                count++;
                            }
                            else
                            {
                                Obj2(5, 25, mx, my, "player");
                                Sleep(1000);
                                count++;
                                play = false;
                            }
                            break;

                    }
                }

                if (!play)
                {
                    int cx, cy, comx, comy;

                    cx = r.Next(1, 11);
                    cy = r.Next(1, 11);

                    comx = fixednum + (cx * 4);
                    comy = fixednum1 + (cy * 2);

                   
                    
                   

                    if (count == 10 || count == 22 || count == 30 || count == 35)
                    {
                        switch (count)
                        {
                            case 10:
                                p = false;
                                Obj4(55, 25, px, py, "com");
                                comx = px; comy = py;
                                Obj(comx, comy, "◎");
                                Sleep(1000);
                                play = true;
                                break;

                            case 22:
                                p1 = false;
                                Obj4(55, 25, px1, py1, "com");
                                comx = px1; comy = py1;
                                Obj(comx, comy, "◎");
                                Sleep(1000);
                                play = true;
                                break;

                            case 30:
                                p2 = false;
                                Obj4(55, 25, px2, py2, "com");
                                comx = px2; comy = py2;
                                Obj(comx, comy, "◎");
                                Sleep(1000);
                                play = true;
                                break;

                            case 35:
                                p3 = false;
                                Obj4(55, 25, px3, py3, "com");
                                comx = px3; comy = py3;
                                Obj(comx, comy, "◎");
                                Sleep(1000);
                                play = true;
                                break;
                        }                          
                    }

                    Obj(comx, comy, "◎");

                    if (comx == px && comy == py)
                    {
                        if (p)
                        {
                            p = false;
                            Obj4(55, 25, comx, comy, "com");
                            Sleep(1000);
                            play = true;
                        }
                    }
                    else if (comx == px1 && comy == py1)
                    {
                        if (p1)
                        {
                            p1 = false;
                            Obj4(55, 25, comx, comy, "com");
                            Sleep(1000);
                            play = true;
                        }
                    }
                    else if (comx == px2 && comy == py2)
                    {
                        if (p2)
                        {
                            p2 = false;
                            Obj4(55, 25, comx, comy, "com");
                            Sleep(1000);
                            play = true;
                        }
                    }
                    else if (comx == px3 && comy == py3)
                    {
                        if (p3)
                        {
                            p3 = false;
                            Obj4(55, 25, comx, comy, "com");
                            Sleep(1000);
                            play = true;
                        }
                    }
                    else if(comx == cskillx && comy == cskilly)
                    {
                        if(citam)
                        {
                            SetCursorPosition(5, 26);
                            WriteLine("com이 유도탄 스위치를 찾았습니다.");
                            Sleep(2000);
                            int itamcr = r.Next(1, 5);
                            switch(itamcr)
                            {
                                case 1:
                                    if (p) Objxy2(15, 27, comx, comy, "com");
                                    Sleep(1000);
                                    p = false;
                                    break;
                                case 2:
                                    if (p1) Objxy2(15, 27, comx, comy, "com");
                                    Sleep(1000);
                                    p1 = false;
                                    break;
                                case 3:
                                    if (p2) Objxy2(15, 27, comx, comy, "com");
                                    Sleep(1000);
                                    p2 = false;
                                    break;
                                case 4:
                                    if (p3) Objxy2(15, 27, comx, comy, "com");
                                    Sleep(1000);
                                    p3 = false;
                                    break;
                                
                            }
                            play = true;
                            citam = false;
                        }
                        else
                        {
                            Obj3(55, 25, comx, comy, "com");
                            Sleep(1000);
                            play = true;
                        }

                    }
                    else
                    {
                        Obj2(55, 25, comx - fixednum, comy, "com");
                        Sleep(1000);
                        play = true;
                    }
                }


                if (!c1 && !c2 && !c3 && !c)
                {                    
                    SetCursorPosition(20, 27);
                    WriteLine("적의 위치를 전부 찾았습니다 Win");
                    break;
                }
                else if (!p && !p1 && !p2 && !p3)
                {
                    SetCursorPosition(20, 27);
                    WriteLine("적이 전함을 전부 찾았습니다 Drow");
                    break;
                }
                else
                    continue;

            }
        }
    }
    class Program
    {
        static void Main(string[] args)
        {
            ConsoleKey key;
            Tast tast = new Tast();
            Screen screen = new Screen();


            while (true)
            {
                screen.Earlyscreen();
                key = ReadKey(true).Key;
                switch (key)
                {
                    case ConsoleKey.Enter:
                        break;
                    default:
                        SetCursorPosition(0, 27);
                        return;
                }

                tast.Game();

                key = ReadKey(true).Key;

                switch (key)
                {
                    case ConsoleKey.NumPad1:
                        continue;
                }
            }

        }
    }
}
